import t from"d3-selection";import n from"d3-dispatch";import e from"d3-timer";import r from"d3-interpolate";import i from"d3-color";import o from"d3-ease";var a="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var s={};(function(a,u){u(s,t,n,e,r,i,o)})(s,(function(t,n,e,r,i,o,s){var u=e.dispatch("start","end","cancel","interrupt");var l=[];var c=0;var f=1;var h=2;var _=3;var v=4;var p=5;var d=6;function schedule(t,n,e,r,i,o){var a=t.__transition;if(a){if(e in a)return}else t.__transition={};create(t,e,{name:n,index:r,group:i,on:u,tween:l,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:c})}function init(t,n){var e=get(t,n);if(e.state>c)throw new Error("too late; already scheduled");return e}function set(t,n){var e=get(t,n);if(e.state>_)throw new Error("too late; already running");return e}function get(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function create(t,n,e){var i=t.__transition,o;i[n]=e;e.timer=r.timer(schedule,0,e.time);function schedule(t){e.state=f;e.timer.restart(start,e.delay,e.time);e.delay<=t&&start(t-e.delay)}function start(a){var s,u,l,c;if(e.state!==f)return stop();for(s in i){c=i[s];if(c.name===e.name){if(c.state===_)return r.timeout(start);if(c.state===v){c.state=d;c.timer.stop();c.on.call("interrupt",t,t.__data__,c.index,c.group);delete i[s]}else if(+s<n){c.state=d;c.timer.stop();c.on.call("cancel",t,t.__data__,c.index,c.group);delete i[s]}}}r.timeout((function(){if(e.state===_){e.state=v;e.timer.restart(tick,e.delay,e.time);tick(a)}}));e.state=h;e.on.call("start",t,t.__data__,e.index,e.group);if(e.state===h){e.state=_;o=new Array(l=e.tween.length);for(s=0,u=-1;s<l;++s)(c=e.tween[s].value.call(t,t.__data__,e.index,e.group))&&(o[++u]=c);o.length=u+1}}function tick(n){var r=n<e.duration?e.ease.call(null,n/e.duration):(e.timer.restart(stop),e.state=p,1),i=-1,a=o.length;while(++i<a)o[i].call(t,r);if(e.state===p){e.on.call("end",t,t.__data__,e.index,e.group);stop()}}function stop(){e.state=d;e.timer.stop();delete i[n];for(var r in i)return;delete t.__transition}}function interrupt(t,n){var e=t.__transition,r,i,o=true,a;if(e){n=null==n?null:n+"";for(a in e)if((r=e[a]).name===n){i=r.state>h&&r.state<p;r.state=d;r.timer.stop();r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group);delete e[a]}else o=false;o&&delete t.__transition}}function selection_interrupt(t){return this.each((function(){interrupt(this||a,t)}))}function tweenRemove(t,n){var e,r;return function(){var i=set(this||a,t),o=i.tween;if(o!==e){r=e=o;for(var s=0,u=r.length;s<u;++s)if(r[s].name===n){r=r.slice();r.splice(s,1);break}}i.tween=r}}function tweenFunction(t,n,e){var r,i;if("function"!==typeof e)throw new Error;return function(){var o=set(this||a,t),s=o.tween;if(s!==r){i=(r=s).slice();for(var u={name:n,value:e},l=0,c=i.length;l<c;++l)if(i[l].name===n){i[l]=u;break}l===c&&i.push(u)}o.tween=i}}function transition_tween(t,n){var e=(this||a)._id;t+="";if(arguments.length<2){var r=get(this.node(),e).tween;for(var i=0,o=r.length,s;i<o;++i)if((s=r[i]).name===t)return s.value;return null}return this.each((null==n?tweenRemove:tweenFunction)(e,t,n))}function tweenValue(t,n,e){var r=t._id;t.each((function(){var t=set(this||a,r);(t.value||(t.value={}))[n]=e.apply(this||a,arguments)}));return function(t){return get(t,r).value[n]}}function interpolate(t,n){var e;return("number"===typeof n?i.interpolateNumber:n instanceof o.color?i.interpolateRgb:(e=o.color(n))?(n=e,i.interpolateRgb):i.interpolateString)(t,n)}function attrRemove(t){return function(){this.removeAttribute(t)}}function attrRemoveNS(t){return function(){this.removeAttributeNS(t.space,t.local)}}function attrConstant(t,n,e){var r,i=e+"",o;return function(){var a=this.getAttribute(t);return a===i?null:a===r?o:o=n(r=a,e)}}function attrConstantNS(t,n,e){var r,i=e+"",o;return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?o:o=n(r=a,e)}}function attrFunction(t,n,e){var r,i,o;return function(){var s,u=e(this||a),l;if(null!=u){s=this.getAttribute(t);l=u+"";return s===l?null:s===r&&l===i?o:(i=l,o=n(r=s,u))}this.removeAttribute(t)}}function attrFunctionNS(t,n,e){var r,i,o;return function(){var s,u=e(this||a),l;if(null!=u){s=this.getAttributeNS(t.space,t.local);l=u+"";return s===l?null:s===r&&l===i?o:(i=l,o=n(r=s,u))}this.removeAttributeNS(t.space,t.local)}}function transition_attr(t,e){var r=n.namespace(t),o="transform"===r?i.interpolateTransformSvg:interpolate;return this.attrTween(t,"function"===typeof e?(r.local?attrFunctionNS:attrFunction)(r,o,tweenValue(this||a,"attr."+t,e)):null==e?(r.local?attrRemoveNS:attrRemove)(r):(r.local?attrConstantNS:attrConstant)(r,o,e))}function attrInterpolate(t,n){return function(e){this.setAttribute(t,n.call(this||a,e))}}function attrInterpolateNS(t,n){return function(e){this.setAttributeNS(t.space,t.local,n.call(this||a,e))}}function attrTweenNS(t,n){var e,r;function tween(){var i=n.apply(this||a,arguments);i!==r&&(e=(r=i)&&attrInterpolateNS(t,i));return e}tween._value=n;return tween}function attrTween(t,n){var e,r;function tween(){var i=n.apply(this||a,arguments);i!==r&&(e=(r=i)&&attrInterpolate(t,i));return e}tween._value=n;return tween}function transition_attrTween(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!==typeof e)throw new Error;var i=n.namespace(t);return this.tween(r,(i.local?attrTweenNS:attrTween)(i,e))}function delayFunction(t,n){return function(){init(this||a,t).delay=+n.apply(this||a,arguments)}}function delayConstant(t,n){return n=+n,function(){init(this||a,t).delay=n}}function transition_delay(t){var n=(this||a)._id;return arguments.length?this.each(("function"===typeof t?delayFunction:delayConstant)(n,t)):get(this.node(),n).delay}function durationFunction(t,n){return function(){set(this||a,t).duration=+n.apply(this||a,arguments)}}function durationConstant(t,n){return n=+n,function(){set(this||a,t).duration=n}}function transition_duration(t){var n=(this||a)._id;return arguments.length?this.each(("function"===typeof t?durationFunction:durationConstant)(n,t)):get(this.node(),n).duration}function easeConstant(t,n){if("function"!==typeof n)throw new Error;return function(){set(this||a,t).ease=n}}function transition_ease(t){var n=(this||a)._id;return arguments.length?this.each(easeConstant(n,t)):get(this.node(),n).ease}function transition_filter(t){"function"!==typeof t&&(t=n.matcher(t));for(var e=(this||a)._groups,r=e.length,i=new Array(r),o=0;o<r;++o)for(var s=e[o],u=s.length,l=i[o]=[],c,f=0;f<u;++f)(c=s[f])&&t.call(c,c.__data__,f,s)&&l.push(c);return new Transition(i,(this||a)._parents,(this||a)._name,(this||a)._id)}function transition_merge(t){if(t._id!==(this||a)._id)throw new Error;for(var n=(this||a)._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),s=new Array(r),u=0;u<o;++u)for(var l=n[u],c=e[u],f=l.length,h=s[u]=new Array(f),_,v=0;v<f;++v)(_=l[v]||c[v])&&(h[v]=_);for(;u<r;++u)s[u]=n[u];return new Transition(s,(this||a)._parents,(this||a)._name,(this||a)._id)}function start(t){return(t+"").trim().split(/^|\s+/).every((function(t){var n=t.indexOf(".");n>=0&&(t=t.slice(0,n));return!t||"start"===t}))}function onFunction(t,n,e){var r,i,o=start(n)?init:set;return function(){var s=o(this||a,t),u=s.on;u!==r&&(i=(r=u).copy()).on(n,e);s.on=i}}function transition_on(t,n){var e=(this||a)._id;return arguments.length<2?get(this.node(),e).on.on(t):this.each(onFunction(e,t,n))}function removeFunction(t){return function(){var n=(this||a).parentNode;for(var e in(this||a).__transition)if(+e!==t)return;n&&n.removeChild(this||a)}}function transition_remove(){return this.on("end.remove",removeFunction((this||a)._id))}function transition_select(t){var e=(this||a)._name,r=(this||a)._id;"function"!==typeof t&&(t=n.selector(t));for(var i=(this||a)._groups,o=i.length,s=new Array(o),u=0;u<o;++u)for(var l=i[u],c=l.length,f=s[u]=new Array(c),h,_,v=0;v<c;++v)if((h=l[v])&&(_=t.call(h,h.__data__,v,l))){"__data__"in h&&(_.__data__=h.__data__);f[v]=_;schedule(f[v],e,r,v,f,get(h,r))}return new Transition(s,(this||a)._parents,e,r)}function transition_selectAll(t){var e=(this||a)._name,r=(this||a)._id;"function"!==typeof t&&(t=n.selectorAll(t));for(var i=(this||a)._groups,o=i.length,s=[],u=[],l=0;l<o;++l)for(var c=i[l],f=c.length,h,_=0;_<f;++_)if(h=c[_]){for(var v=t.call(h,h.__data__,_,c),p,d=get(h,r),y=0,w=v.length;y<w;++y)(p=v[y])&&schedule(p,e,r,y,v,d);s.push(v);u.push(h)}return new Transition(s,u,e,r)}var y=n.selection.prototype.constructor;function transition_selection(){return new y((this||a)._groups,(this||a)._parents)}function styleNull(t,e){var r,i,o;return function(){var s=n.style(this||a,t),u=((this||a).style.removeProperty(t),n.style(this||a,t));return s===u?null:s===r&&u===i?o:o=e(r=s,i=u)}}function styleRemove(t){return function(){(this||a).style.removeProperty(t)}}function styleConstant(t,e,r){var i,o=r+"",s;return function(){var u=n.style(this||a,t);return u===o?null:u===i?s:s=e(i=u,r)}}function styleFunction(t,e,r){var i,o,s;return function(){var u=n.style(this||a,t),l=r(this||a),c=l+"";null==l&&(c=l=((this||a).style.removeProperty(t),n.style(this||a,t)));return u===c?null:u===i&&c===o?s:(o=c,s=e(i=u,l))}}function styleMaybeRemove(t,n){var e,r,i,o="style."+n,s="end."+o,u;return function(){var l=set(this||a,t),c=l.on,f=null==l.value[o]?u||(u=styleRemove(n)):void 0;c===e&&i===f||(r=(e=c).copy()).on(s,i=f);l.on=r}}function transition_style(t,n,e){var r="transform"===(t+="")?i.interpolateTransformCss:interpolate;return null==n?this.styleTween(t,styleNull(t,r)).on("end.style."+t,styleRemove(t)):"function"===typeof n?this.styleTween(t,styleFunction(t,r,tweenValue(this||a,"style."+t,n))).each(styleMaybeRemove((this||a)._id,t)):this.styleTween(t,styleConstant(t,r,n),e).on("end.style."+t,null)}function styleInterpolate(t,n,e){return function(r){(this||a).style.setProperty(t,n.call(this||a,r),e)}}function styleTween(t,n,e){var r,i;function tween(){var o=n.apply(this||a,arguments);o!==i&&(r=(i=o)&&styleInterpolate(t,o,e));return r}tween._value=n;return tween}function transition_styleTween(t,n,e){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==n)return this.tween(r,null);if("function"!==typeof n)throw new Error;return this.tween(r,styleTween(t,n,null==e?"":e))}function textConstant(t){return function(){(this||a).textContent=t}}function textFunction(t){return function(){var n=t(this||a);(this||a).textContent=null==n?"":n}}function transition_text(t){return this.tween("text","function"===typeof t?textFunction(tweenValue(this||a,"text",t)):textConstant(null==t?"":t+""))}function textInterpolate(t){return function(n){(this||a).textContent=t.call(this||a,n)}}function textTween(t){var n,e;function tween(){var r=t.apply(this||a,arguments);r!==e&&(n=(e=r)&&textInterpolate(r));return n}tween._value=t;return tween}function transition_textTween(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!==typeof t)throw new Error;return this.tween(n,textTween(t))}function transition_transition(){var t=(this||a)._name,n=(this||a)._id,e=newId();for(var r=(this||a)._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],u=s.length,l,c=0;c<u;++c)if(l=s[c]){var f=get(l,n);schedule(l,t,e,c,s,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Transition(r,(this||a)._parents,t,e)}function transition_end(){var t,n,e=this||a,r=e._id,i=e.size();return new Promise((function(o,s){var u={value:s},l={value:function(){0===--i&&o()}};e.each((function(){var e=set(this||a,r),i=e.on;if(i!==t){n=(t=i).copy();n._.cancel.push(u);n._.interrupt.push(u);n._.end.push(l)}e.on=n}))}))}var w=0;function Transition(t,n,e,r){(this||a)._groups=t;(this||a)._parents=n;(this||a)._name=e;(this||a)._id=r}function transition(t){return n.selection().transition(t)}function newId(){return++w}var m=n.selection.prototype;Transition.prototype=transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:m.call,nodes:m.nodes,node:m.node,size:m.size,empty:m.empty,each:m.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,textTween:transition_textTween,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease,end:transition_end};var g={time:null,delay:0,duration:250,ease:s.easeCubicInOut};function inherit(t,n){var e;while(!(e=t.__transition)||!(e=e[n]))if(!(t=t.parentNode))return g.time=r.now(),g;return e}function selection_transition(t){var n,e;t instanceof Transition?(n=t._id,t=t._name):(n=newId(),(e=g).time=r.now(),t=null==t?null:t+"");for(var i=(this||a)._groups,o=i.length,s=0;s<o;++s)for(var u=i[s],l=u.length,c,f=0;f<l;++f)(c=u[f])&&schedule(c,t,n,f,u,e||inherit(c,n));return new Transition(i,(this||a)._parents,t,n)}n.selection.prototype.interrupt=selection_interrupt;n.selection.prototype.transition=selection_transition;var T=[null];function active(t,n){var e=t.__transition,r,i;if(e){n=null==n?null:n+"";for(i in e)if((r=e[i]).state>f&&r.name===n)return new Transition([[t]],T,n,+i)}return null}t.active=active;t.interrupt=interrupt;t.transition=transition;Object.defineProperty(t,"__esModule",{value:true})}));const u=s.active,l=s.interrupt,c=s.transition,f=s.__esModule;export default s;export{f as __esModule,u as active,l as interrupt,c as transition};

